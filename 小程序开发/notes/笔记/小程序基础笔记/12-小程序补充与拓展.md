### æ¡†æ¶æ¥å£-getApp



`getApp()`  ç”¨äºè·å–å°ç¨‹åºå…¨å±€å”¯ä¸€çš„ `App` å®ä¾‹ï¼Œé€šè¿‡å°ç¨‹åºåº”ç”¨å®ä¾‹å¯å®ç°æ•°æ®æˆ–æ–¹æ³•çš„å…±äº«



> ğŸ“Œ **æ³¨æ„äº‹é¡¹**ï¼š
>
> 1. 1.ä¸è¦åœ¨ App() æ–¹æ³•ä¸­ä½¿ç”¨ getApp() ï¼Œä½¿ç”¨ this å°±å¯ä»¥æ‹¿åˆ° app å®ä¾‹
> 2. é€šè¿‡ `getApp()` è·å–å®ä¾‹ä¹‹åï¼Œä¸è¦ç§è‡ªè°ƒç”¨ç”Ÿå‘½å‘¨æœŸå‡½æ•°



**è½åœ°ä»£ç ï¼š**

`â¡ï¸ app.js`

```js
App({

  // å…¨å±€å…±äº«çš„æ•°æ®
  globalData: {
    token: ''
  },

  // å…¨å±€å…±äº«çš„æ–¹æ³•
  setToken (token) {
    // å¦‚æœæƒ³è·å– tokenï¼Œå¯ä»¥ä½¿ç”¨ this çš„æ–¹å¼è¿›è¡Œè·å–
    this.globalData.token = token

    // åœ¨ App() æ–¹æ³•ä¸­å¦‚æœæƒ³è·å– App() å®ä¾‹ï¼Œå¯ä»¥é€šè¿‡ this çš„æ–¹å¼è¿›è¡Œè·å–
    // ä¸èƒ½é€šè¿‡ getApp() æ–¹æ³•è·å–
  }

})
```



`â¡ï¸ pages/index/index.js`

```js
// getApp() æ–¹æ³•ç”¨æ¥è·å–å…¨å±€å”¯ä¸€çš„ App() å®ä¾‹
const appInstance = getApp()

Page({

  login () {

    // ä¸è¦é€šè¿‡ app å®ä¾‹è°ƒç”¨é’©å­å‡½æ•°
    console.log(appInstance)

    appInstance.setToken('fghioiuytfghjkoiuytghjoiug')

  }

})
```



<img src="http://8.131.91.46:6677/mina/base/50-getApp.jpg" style="zoom:70%;" />







### å°ç¨‹åºé¡µé¢é—´é€šä¿¡



å¦‚æœä¸€ä¸ªé¡µé¢é€šè¿‡ `wx.navigateTo` æ‰“å¼€ä¸€ä¸ªæ–°é¡µé¢ï¼Œè¿™ä¸¤ä¸ªé¡µé¢é—´å°†å»ºç«‹ä¸€æ¡æ•°æ®é€šé“



1. åœ¨ `wx.navigateTo` çš„ `success` å›è°ƒä¸­é€šè¿‡ `EventChannel` å¯¹è±¡å‘å°„äº‹ä»¶

2. è¢«æ‰“å¼€çš„é¡µé¢å¯ä»¥é€šè¿‡ `this.getOpenerEventChannel()` æ–¹æ³•è·å¾—ä¸€ä¸ª `EventChannel` å¯¹è±¡ï¼Œè¿›è¡Œç›‘å¬ã€å‘å°„äº‹ä»¶

3. `wx.navigateTo` æ–¹æ³•ä¸­å¯ä»¥å®šä¹‰ `events` é…ç½®é¡¹æ¥æ”¶è¢«æ‰“å¼€é¡µé¢å‘å°„çš„äº‹ä»¶



è¿™ä¸¤ä¸ª `EventChannel` å¯¹è±¡é—´å¯ä»¥ä½¿ç”¨ `emit` å’Œ `on` æ–¹æ³•ç›¸äº’å‘é€ã€ç›‘å¬äº‹ä»¶ã€‚



<img src="http://8.131.91.46:6677/mina/base/å°ç¨‹åºé¡µé¢é—´é€šä¿¡.png" style="zoom: 60%;" />





**è½åœ°ä»£ç ï¼š**



é¡µé¢ .js æ–‡ä»¶

```js
Page({

  // ç‚¹å‡»æŒ‰é’®è§¦å‘çš„äº‹ä»¶å¤„ç†å‡½æ•°
  handler () {

    wx.navigateTo({
      url: '/pages/list/list',
      events: {
        // keyï¼šè¢«æ‰“å¼€é¡µé¢é€šè¿‡ eventChannel å‘å°„çš„äº‹ä»¶
        // valueï¼šå›è°ƒå‡½æ•°
        // ä¸ºäº‹ä»¶æ·»åŠ ä¸€ä¸ªç›‘å¬å™¨ï¼Œè·å–åˆ°è¢«æ‰“å¼€é¡µé¢ä¼ é€’ç»™å½“å‰é¡µé¢çš„æ•°æ®
        currentevent: (res) => {
          console.log(res)
        }
      },
      success (res) {
        // console.log(res)
        // é€šè¿‡ success å›è°ƒå‡½æ•°çš„å½¢å‚ï¼Œå¯ä»¥è·å– eventChannel å¯¹è±¡
        // eventChannel å¯¹è±¡ç»™æä¾›äº† emit æ–¹æ³•ï¼Œå¯ä»¥å‘å°„äº‹ä»¶ï¼ŒåŒæ—¶æºå¸¦å‚æ•°
        res.eventChannel.emit('myevent', { name: 'tom' })
      }
    })

  }

})
```



è¢«é¡µé¢ .js æ–‡ä»¶

```js
Page({

  onLoad () {

    // é€šè¿‡ this.getOpenerEventChannel() å¯ä»¥è·å– EventChannel å¯¹è±¡
    const EventChannel = this.getOpenerEventChannel()

    // é€šè¿‡ EventChannel æä¾›çš„ on æ–¹æ³•ç›‘å¬é¡µé¢å‘å°„çš„è‡ªå®šä¹‰äº‹ä»¶
    EventChannel.on('myevent', (res) => {
      console.log(res)
    })

    // é€šè¿‡ EventChannel æä¾›çš„ emit æ–¹æ³•ä¹Ÿå¯ä»¥å‘ä¸Šä¸€çº§é¡µé¢ä¼ é€’æ•°æ®
    // éœ€è¦ä½¿ç”¨ emit å®šä¹‰è‡ªå®šä¹‰äº‹ä»¶ï¼Œæºå¸¦éœ€è¦ä¼ é€’çš„æ•°æ®
    EventChannel.emit('currentevent', { age: 10 })

  }

})
```









### è‡ªå®šä¹‰å¯¼èˆªæ 



å°ç¨‹åºé»˜è®¤çš„å¯¼èˆªæ ä¸ APP ä¸€æ ·éƒ½ä½äºé¡¶éƒ¨å›ºå®šä½ç½®ã€‚ä½†æ˜¯é»˜è®¤å¯¼èˆªæ å¯èƒ½ä¼šå½±å“å°ç¨‹åºæ•´ä½“é£æ ¼ï¼Œä¸”æ— æ³•æ»¡è¶³ç‰¹å®šçš„è®¾è®¡éœ€æ±‚ï¼Œè¿™æ—¶å€™ï¼Œå°±éœ€è¦è¿›è¡Œè‡ªå®šä¹‰å¯¼èˆªæ ã€‚



<img src="http://8.131.91.46:6677/mina/base/è‡ªå®šä¹‰ TabBar.png" style="zoom:60%;" />



åœ¨ app.json æˆ–è€… page.json ä¸­ï¼Œ**é…ç½® navigationStyle å±æ€§ä¸º custom**ï¼Œå³å¯ è‡ªå®šä¹‰å¯¼èˆªæ 

åœ¨è®¾ç½®ä»¥åï¼Œå°±ä¼šç§»é™¤é»˜è®¤çš„å¯¼èˆªæ ï¼Œåªä¿ç•™å³ä¸Šè§’èƒ¶å›ŠæŒ‰é’®





**è½åœ°ä»£ç ï¼š**

```json
{
  "usingComponents": {},
  "navigationStyle": "custom"
}
```



```html
<!--pages/cate/cate.wxml-->
<!-- <text>pages/cate/cate.wxml</text> -->

<swiper class="custom-swiper" indicator-dots autoplay interval="2000">
  <swiper-item>
    <image src="../../assets/banner/banner-1.png" mode=""/>
  </swiper-item>

  <swiper-item>
    <image src="../../assets/banner/banner-2.png" mode=""/>
  </swiper-item>

  <swiper-item>
    <image src="../../assets/banner/banner-3.png" mode=""/>
  </swiper-item>
</swiper>
```



```js
/* pages/cate/cate.wxss */

.custom-swiper {
  height: 440rpx;
}

.custom-swiper image {
  height: 100%;
  width: 100%;
}

```

